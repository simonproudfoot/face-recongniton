const faceapi=require("face-api.js"),express=require("express"),path=require("node:path"),fetch=require("cross-fetch"),request=require("request"),canvas=require("canvas"),urllib=require("urllib"),tf=require("@tensorflow/tfjs"),{cos:cos}=require("@tensorflow/tfjs");require("@tensorflow/tfjs");const base64=require("node-base64-image"),{Canvas:Canvas,Image:Image,ImageData:ImageData}=canvas;faceapi.env.monkeyPatch({Canvas:Canvas,Image:Image,ImageData:ImageData}),require("@tensorflow/tfjs-node");const app=express(),port=3e3;let allFaces=[],refImage="",loadedFaces=[];async function loadFacesFromDb(img,data){return console.log("loadFacesFromDb"),!0}function loadImageData(urlToCall,callback){console.log("loadImageData"),urllib.request(urlToCall,{json:!0,wd:"nodejs"},(function(err,data,response){var statusCode=response.statusCode;let finalData;callback(data)}))}async function getRefImage(urlToCall){console.log("getRefImage");const url=urlToCall,options={string:!0,headers:{"User-Agent":"my-app"}},image=await base64.encode(url,options);return image}app.get("/",async(req,res)=>{const url="https://lp-picture-library.greenwich-design-projects.co.uk/wp-content/uploads/2022/04/chloe-brockett-crop-300x300.jpg",dataUrl="http://localhost:8888/lime-pictures-photo-library/wp/wp-json/faces";await faceapi.nets.faceRecognitionNet.loadFromDisk(path.join(__dirname,"models")),await faceapi.nets.faceLandmark68Net.loadFromDisk(path.join(__dirname,"models")),await faceapi.nets.ssdMobilenetv1.loadFromDisk(path.join(__dirname,"models")),res.send("done")}),app.listen(3e3,()=>{console.log("Example app listening on port 3000")});